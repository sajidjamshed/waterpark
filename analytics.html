<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WonderPark - Analytics Dashboard</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
    <!-- ApexCharts for graphs -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/apexcharts@3.35.0/dist/apexcharts.css">
    <!-- Date Range Picker -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
      <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <style>
        :root {
            --sky-blue: #4fc3f7;
            --primary-blue: #0288d1;
            --dark-blue: #01579b;
            --light-bg: #e3f2fd;
            --sidebar-width: 260px;
            --success-green: #28a745;
            --warning-orange: #ffc107;
            --danger-red: #dc3545;
            --purple: #6f42c1;
            --teal: #20c997;
            --pink: #e83e8c;
            --indigo: #6610f2;
            --cyan: #17a2b8;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Poppins', sans-serif;
            background-color: #f8f9fa;
            overflow-x: hidden;
        }
        
        /* Sidebar Styles */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: var(--sidebar-width);
            background: linear-gradient(180deg, var(--dark-blue) 0%, var(--primary-blue) 100%);
            color: white;
            padding: 0;
            z-index: 1000;
            box-shadow: 3px 0 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }
        
        .sidebar-header {
            padding: 25px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .park-logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
        }
        
        .park-logo span {
            color: var(--sky-blue);
        }
        
        .sidebar-menu {
            padding: 20px 0;
            height: calc(100vh - 120px);
            overflow-y: auto;
        }
        
        .nav-item {
            margin-bottom: 5px;
        }
        
        .nav-link {
            color: rgba(255, 255, 255, 0.8);
            padding: 15px 25px;
            display: flex;
            align-items: center;
            transition: all 0.3s;
            border-left: 4px solid transparent;
        }
        
        .nav-link:hover, .nav-link.active {
            color: white;
            background: rgba(255, 255, 255, 0.1);
            border-left: 4px solid var(--sky-blue);
        }
        
        .nav-link i {
            width: 25px;
            margin-right: 12px;
            font-size: 1.2rem;
        }
        
        /* Main Content Styles */
        .main-content {
            margin-left: var(--sidebar-width);
            padding: 20px;
            transition: all 0.3s;
        }
        
        .topbar {
            background: white;
            border-radius: 12px;
            padding: 15px 25px;
            margin-bottom: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .search-box {
            position: relative;
            width: 300px;
        }
        
        .search-box input {
            width: 100%;
            padding: 10px 15px 10px 45px;
            border-radius: 8px;
            border: 1px solid #ddd;
            background: var(--light-bg);
        }
        
        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-blue);
        }
        
        .user-info {
            display: flex;
            align-items: center;
        }
        
        .user-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--sky-blue), var(--primary-blue));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            margin-right: 15px;
        }
        
        .notifications {
            position: relative;
            margin-right: 25px;
            cursor: pointer;
        }
        
        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff4757;
            color: white;
            font-size: 0.7rem;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Page Header */
        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .page-title h1 {
            color: var(--dark-blue);
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .page-title p {
            color: #666;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        
        .btn-primary-custom {
            background: var(--primary-blue);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn-primary-custom:hover {
            background: var(--dark-blue);
            color: white;
            transform: translateY(-2px);
        }
        
        /* Analytics Filter Section */
        .analytics-filter {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .filter-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .filter-title {
            color: var(--dark-blue);
            font-weight: 600;
            font-size: 1.2rem;
        }
        
        .filter-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 15px;
        }
        
        .filter-group {
            flex: 1;
            min-width: 200px;
        }
        
        .filter-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark-blue);
        }
        
        .filter-control {
            width: 100%;
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            background: white;
            font-family: 'Poppins', sans-serif;
        }
        
        .filter-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 10px;
        }
        
        .btn-filter {
            padding: 10px 25px;
            border-radius: 8px;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-apply {
            background: var(--primary-blue);
            color: white;
        }
        
        .btn-reset {
            background: #f8f9fa;
            color: #666;
            border: 1px solid #ddd;
        }
        
        /* KPI Cards */
        .kpi-container {
            margin-bottom: 30px;
        }
        
        .kpi-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            height: 100%;
            transition: transform 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .kpi-card:hover {
            transform: translateY(-5px);
        }
        
        .kpi-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .kpi-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }
        
        .kpi-icon.blue {
            background: linear-gradient(135deg, var(--primary-blue), var(--sky-blue));
        }
        
        .kpi-icon.green {
            background: linear-gradient(135deg, var(--success-green), #5cd85c);
        }
        
        .kpi-icon.purple {
            background: linear-gradient(135deg, var(--purple), #a663cc);
        }
        
        .kpi-icon.orange {
            background: linear-gradient(135deg, var(--warning-orange), #ffd166);
        }
        
        .kpi-change {
            font-size: 0.9rem;
            font-weight: 600;
            padding: 3px 10px;
            border-radius: 15px;
        }
        
        .change-positive {
            background: rgba(40, 167, 69, 0.1);
            color: var(--success-green);
        }
        
        .change-negative {
            background: rgba(220, 53, 69, 0.1);
            color: var(--danger-red);
        }
        
        .kpi-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--dark-blue);
            margin-bottom: 5px;
        }
        
        .kpi-label {
            color: #666;
            font-size: 0.95rem;
            margin-bottom: 15px;
        }
        
        .kpi-trend {
            height: 60px;
            margin-top: 10px;
        }
        
        /* Charts Section */
        .charts-section {
            margin-bottom: 30px;
        }
        
        .chart-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            height: 100%;
            margin-bottom: 25px;
        }
        
        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .chart-title {
            color: var(--dark-blue);
            font-weight: 600;
            font-size: 1.2rem;
        }
        
        .chart-actions {
            display: flex;
            gap: 10px;
        }
        
        .chart-action-btn {
            width: 35px;
            height: 35px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #ddd;
            background: white;
            color: #666;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .chart-action-btn:hover {
            background: var(--light-bg);
            color: var(--primary-blue);
        }
        
        /* Performance Metrics */
        .metrics-section {
            margin-bottom: 30px;
        }
        
        .metrics-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            height: 100%;
        }
        
        .metric-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }
        
        .metric-item:last-child {
            border-bottom: none;
        }
        
        .metric-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .metric-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1rem;
        }
        
        .metric-details h5 {
            margin: 0;
            font-size: 1rem;
            color: #333;
        }
        
        .metric-details p {
            margin: 0;
            font-size: 0.85rem;
            color: #666;
        }
        
        .metric-value {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--dark-blue);
        }
        
        /* Analytics Tables */
        .analytics-tables {
            margin-bottom: 30px;
        }
        
        .table-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            height: 100%;
        }
        
        .table-responsive {
            overflow-x: auto;
        }
        
        .analytics-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .analytics-table thead {
            background: var(--light-bg);
        }
        
        .analytics-table th {
            padding: 15px;
            text-align: left;
            color: var(--dark-blue);
            font-weight: 600;
            border-bottom: 2px solid #dee2e6;
        }
        
        .analytics-table td {
            padding: 15px;
            border-bottom: 1px solid #eee;
            vertical-align: middle;
        }
        
        .analytics-table tbody tr:hover {
            background: #f8f9fa;
        }
        
        /* Heat Map */
        .heatmap-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .heatmap-container {
            height: 400px;
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }
        
        .heatmap-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
            padding: 20px;
            height: 100%;
        }
        
        .heatmap-cell {
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .heatmap-cell:hover {
            transform: scale(1.05);
        }
        
        .heatmap-legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 0.9rem;
            color: #666;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        
        /* Insights Section */
        .insights-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            margin-bottom: 30px;
        }
        
        .insight-card {
            background: var(--light-bg);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid var(--primary-blue);
        }
        
        .insight-card.warning {
            border-left-color: var(--warning-orange);
            background: #fff3cd;
        }
        
        .insight-card.success {
            border-left-color: var(--success-green);
            background: #d4edda;
        }
        
        .insight-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }
        
        .insight-title {
            font-weight: 600;
            color: var(--dark-blue);
            font-size: 1rem;
        }
        
        .insight-time {
            font-size: 0.85rem;
            color: #666;
        }
        
        .insight-text {
            color: #333;
            font-size: 0.95rem;
            margin-bottom: 10px;
        }
        
        .insight-action {
            color: var(--primary-blue);
            font-weight: 600;
            font-size: 0.9rem;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .sidebar {
                width: 70px;
                overflow: hidden;
            }
            
            .sidebar:hover {
                width: var(--sidebar-width);
            }
            
            .sidebar .nav-link span {
                opacity: 0;
            }
            
            .sidebar:hover .nav-link span {
                opacity: 1;
            }
            
            .main-content {
                margin-left: 70px;
            }
            
            .sidebar-header .logo-text {
                display: none;
            }
            
            .sidebar:hover .logo-text {
                display: block;
            }
            
            .filter-row {
                flex-direction: column;
            }
            
            .filter-group {
                min-width: 100%;
            }
        }
        
        @media (max-width: 768px) {
            .main-content {
                margin-left: 0;
                padding: 15px;
            }
            
            .sidebar {
                transform: translateX(-100%);
            }
            
            .sidebar.mobile-open {
                transform: translateX(0);
            }
            
            .topbar {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .search-box {
                width: 100%;
                margin-bottom: 15px;
            }
            
            .page-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .action-buttons {
                width: 100%;
                justify-content: flex-start;
            }
            
            .chart-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
        }
        
        /* Mobile menu button */
        .mobile-menu-btn {
            display: none;
            background: var(--primary-blue);
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 8px;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            margin-right: 15px;
        }
        
        @media (max-width: 768px) {
            .mobile-menu-btn {
                display: flex;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
      <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <a href="#" class="park-logo">
                <i class="fas fa-ferris-wheel me-2"></i>
                <span class="logo-text">Wonder<span>Park</span></span>
            </a>
        </div>
        
        <div class="sidebar-menu">
            <ul class="nav flex-column">
                <li class="nav-item">
                    <a class="nav-link active" href="#">
                        <i class="fas fa-home"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="ticketsales.html">
                        <i class="fas fa-ticket-alt"></i>
                        <span>Ticket Sales</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="visitors.html">
                        <i class="fas fa-users"></i>
                        <span>Visitors</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="ridesactivities.html">
                        <i class="fas fa-robot"></i>
                        <span>Rides & Activities</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="terminals.html">
                        <i class="fas fa-terminal"></i>
                        <span>Terminals</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="analytics.html">
                        <i class="fas fa-chart-line"></i>
                        <span>Analytics</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="users.html">
                        <i class="fas fa-cog"></i>
                        <span>Users</span>
                    </a>
                </li>
                <li class="nav-item mt-4">
                    <a class="nav-link" href="login.html">
                        <i class="fas fa-sign-out-alt"></i>
                        <span>Logout</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>
    
    <!-- Main Content -->
    <div class="main-content" id="mainContent">
        <!-- Top Bar -->
        <div class="topbar">
            <div class="d-flex align-items-center">
                <button class="mobile-menu-btn" id="mobileMenuBtn">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search analytics, metrics, reports...">
                </div>
            </div>
            
            <div class="user-info">
                <div class="notifications">
                    <i class="fas fa-bell fa-lg" style="color: var(--primary-blue);"></i>
                    <span class="notification-badge">12</span>
                </div>
                <div class="user-avatar">AS</div>
                <div>
                    <h6 class="mb-0">Admin Saleem</h6>
                    <p class="text-muted mb-0" style="font-size: 0.85rem;">Park Manager</p>
                </div>
            </div>
        </div>
        
        <!-- Page Header -->
        <div class="page-header">
            <div class="page-title">
                <h1><i class="fas fa-chart-line me-2"></i>Analytics Dashboard</h1>
                <p>Advanced analytics, insights, and performance metrics for WonderPark</p>
            </div>
            <div class="action-buttons">
                <button class="btn-primary-custom" onclick="generateReport()">
                    <i class="fas fa-file-pdf"></i> Generate Report
                </button>
                <button class="btn-primary-custom" onclick="scheduleReport()">
                    <i class="fas fa-calendar-alt"></i> Schedule Report
                </button>
            </div>
        </div>
        
        <!-- Analytics Filter Section -->
        <div class="analytics-filter">
            <div class="filter-header">
                <h3 class="filter-title"><i class="fas fa-filter me-2"></i>Analytics Filters</h3>
                <button class="btn btn-sm btn-outline-primary" onclick="saveFilterPreset()">
                    <i class="fas fa-save me-1"></i>Save Preset
                </button>
            </div>
            
            <div class="filter-row">
                <div class="filter-group">
                    <label class="filter-label" for="analyticsDateRange">Date Range</label>
                    <input type="text" class="filter-control" id="analyticsDateRange" placeholder="Select date range">
                </div>
                <div class="filter-group">
                    <label class="filter-label" for="comparisonPeriod">Comparison Period</label>
                    <select class="filter-control" id="comparisonPeriod">
                        <option value="none">No Comparison</option>
                        <option value="previous_week">Previous Week</option>
                        <option value="previous_month">Previous Month</option>
                        <option value="previous_year">Previous Year</option>
                        <option value="custom">Custom Period</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label" for="dataGranularity">Data Granularity</label>
                    <select class="filter-control" id="dataGranularity">
                        <option value="hourly">Hourly</option>
                        <option value="daily" selected>Daily</option>
                        <option value="weekly">Weekly</option>
                        <option value="monthly">Monthly</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label" for="parkZones">Park Zones</label>
                    <select class="filter-control" id="parkZones">
                        <option value="all">All Zones</option>
                        <option value="main">Main Gate Area</option>
                        <option value="adventure">Adventure Zone</option>
                        <option value="fantasy">Fantasy Land</option>
                        <option value="water">Water World</option>
                        <option value="thrill">Thrill Valley</option>
                        <option value="kids">Kids Kingdom</option>
                    </select>
                </div>
            </div>
            
            <div class="filter-actions">
                <button class="btn-filter btn-reset" onclick="resetAnalyticsFilters()">
                    <i class="fas fa-redo"></i> Reset Filters
                </button>
                <button class="btn-filter btn-apply" onclick="applyAnalyticsFilters()">
                    <i class="fas fa-chart-bar"></i> Apply Analytics
                </button>
            </div>
        </div>
        
        <!-- KPI Cards -->
        <div class="row kpi-container">
            <div class="col-xl-3 col-lg-6">
                <div class="kpi-card">
                    <div class="kpi-header">
                        <div class="kpi-icon blue">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <span class="kpi-change change-positive">
                            <i class="fas fa-arrow-up me-1"></i>15.2%
                        </span>
                    </div>
                    <h2 class="kpi-value" id="totalRevenue">PKR 4.8M</h2>
                    <p class="kpi-label">Total Revenue Today</p>
                    <div class="kpi-trend" id="revenueTrend"></div>
                </div>
            </div>
            <div class="col-xl-3 col-lg-6">
                <div class="kpi-card">
                    <div class="kpi-header">
                        <div class="kpi-icon green">
                            <i class="fas fa-users"></i>
                        </div>
                        <span class="kpi-change change-positive">
                            <i class="fas fa-arrow-up me-1"></i>8.7%
                        </span>
                    </div>
                    <h2 class="kpi-value" id="totalVisitors">3,891</h2>
                    <p class="kpi-label">Total Visitors Today</p>
                    <div class="kpi-trend" id="visitorsTrend"></div>
                </div>
            </div>
            <div class="col-xl-3 col-lg-6">
                <div class="kpi-card">
                    <div class="kpi-header">
                        <div class="kpi-icon purple">
                            <i class="fas fa-ticket-alt"></i>
                        </div>
                        <span class="kpi-change change-positive">
                            <i class="fas fa-arrow-up me-1"></i>12.4%
                        </span>
                    </div>
                    <h2 class="kpi-value" id="ticketsSold">2,847</h2>
                    <p class="kpi-label">Tickets Sold Today</p>
                    <div class="kpi-trend" id="ticketsTrend"></div>
                </div>
            </div>
            <div class="col-xl-3 col-lg-6">
                <div class="kpi-card">
                    <div class="kpi-header">
                        <div class="kpi-icon orange">
                            <i class="fas fa-star"></i>
                        </div>
                        <span class="kpi-change change-negative">
                            <i class="fas fa-arrow-down me-1"></i>2.1%
                        </span>
                    </div>
                    <h2 class="kpi-value" id="satisfaction">4.6</h2>
                    <p class="kpi-label">Avg. Satisfaction Score</p>
                    <div class="kpi-trend" id="satisfactionTrend"></div>
                </div>
            </div>
        </div>
        
        <!-- Main Charts Section -->
        <div class="row charts-section">
            <div class="col-lg-8">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-chart-line me-2"></i>Revenue & Visitor Trends</h3>
                        <div class="chart-actions">
                            <button class="chart-action-btn" title="Download Chart">
                                <i class="fas fa-download"></i>
                            </button>
                            <button class="chart-action-btn" title="Full Screen">
                                <i class="fas fa-expand"></i>
                            </button>
                        </div>
                    </div>
                    <div id="revenueVisitorChart" style="height: 350px;"></div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-chart-pie me-2"></i>Revenue by Category</h3>
                        <div class="chart-actions">
                            <button class="chart-action-btn" title="Download Chart">
                                <i class="fas fa-download"></i>
                            </button>
                        </div>
                    </div>
                    <div id="revenueCategoryChart" style="height: 350px;"></div>
                </div>
            </div>
        </div>
        
        <!-- Secondary Charts Section -->
        <div class="row charts-section">
            <div class="col-lg-6">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-chart-bar me-2"></i>Ride Utilization Analysis</h3>
                        <div class="chart-actions">
                            <button class="chart-action-btn" onclick="exportRideData()" title="Export Data">
                                <i class="fas fa-file-export"></i>
                            </button>
                        </div>
                    </div>
                    <div id="rideUtilizationChart" style="height: 300px;"></div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="chart-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-hourglass-half me-2"></i>Average Wait Times</h3>
                        <div class="chart-actions">
                            <button class="chart-action-btn" onclick="exportWaitTimeData()" title="Export Data">
                                <i class="fas fa-file-export"></i>
                            </button>
                        </div>
                    </div>
                    <div id="waitTimeChart" style="height: 300px;"></div>
                </div>
            </div>
        </div>
        
        <!-- Performance Metrics -->
        <div class="row metrics-section">
            <div class="col-lg-4">
                <div class="metrics-card">
                    <h5 class="chart-title mb-4"><i class="fas fa-tachometer-alt me-2"></i>Park Performance</h5>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-icon" style="background: var(--primary-blue);">
                                <i class="fas fa-user-clock"></i>
                            </div>
                            <div class="metric-details">
                                <h5>Avg. Stay Duration</h5>
                                <p>Time spent in park</p>
                            </div>
                        </div>
                        <div class="metric-value">5.2 hrs</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-icon" style="background: var(--success-green);">
                                <i class="fas fa-sync-alt"></i>
                            </div>
                            <div class="metric-details">
                                <h5>Ride Turnover Rate</h5>
                                <p>Rides per visitor</p>
                            </div>
                        </div>
                        <div class="metric-value">8.7</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-icon" style="background: var(--warning-orange);">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="metric-details">
                                <h5>Peak Wait Time</h5>
                                <p>Maximum queue time</p>
                            </div>
                        </div>
                        <div class="metric-value">42 min</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-icon" style="background: var(--purple);">
                                <i class="fas fa-percentage"></i>
                            </div>
                            <div class="metric-details">
                                <h5>Capacity Utilization</h5>
                                <p>Park capacity used</p>
                            </div>
                        </div>
                        <div class="metric-value">78%</div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4">
                <div class="metrics-card">
                    <h5 class="chart-title mb-4"><i class="fas fa-terminal me-2"></i>Terminal Performance</h5>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-icon" style="background: var(--success-green);">
                                <i class="fas fa-wifi"></i>
                            </div>
                            <div class="metric-details">
                                <h5>Terminal Uptime</h5>
                                <p>System availability</p>
                            </div>
                        </div>
                        <div class="metric-value">99.2%</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-icon" style="background: var(--primary-blue);">
                                <i class="fas fa-ticket-alt"></i>
                            </div>
                            <div class="metric-details">
                                <h5>Avg. Transaction Time</h5>
                                <p>Time per ticket sale</p>
                            </div>
                        </div>
                        <div class="metric-value">32 sec</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-icon" style="background: var(--warning-orange);">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <div class="metric-details">
                                <h5>Error Rate</h5>
                                <p>Failed transactions</p>
                            </div>
                        </div>
                        <div class="metric-value">1.2%</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-icon" style="background: var(--cyan);">
                                <i class="fas fa-money-check-alt"></i>
                            </div>
                            <div class="metric-details">
                                <h5>Revenue per Terminal</h5>
                                <p>Average performance</p>
                            </div>
                        </div>
                        <div class="metric-value">PKR 267K</div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-4">
                <div class="metrics-card">
                    <h5 class="chart-title mb-4"><i class="fas fa-user-check me-2"></i>Visitor Experience</h5>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-icon" style="background: var(--success-green);">
                                <i class="fas fa-star"></i>
                            </div>
                            <div class="metric-details">
                                <h5>Satisfaction Score</h5>
                                <p>Visitor feedback</p>
                            </div>
                        </div>
                        <div class="metric-value">4.6/5</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-icon" style="background: var(--warning-orange);">
                                <i class="fas fa-frown"></i>
                            </div>
                            <div class="metric-details">
                                <h5>Complaint Rate</h5>
                                <p>Negative feedback</p>
                            </div>
                        </div>
                        <div class="metric-value">3.8%</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-icon" style="background: var(--purple);">
                                <i class="fas fa-redo"></i>
                            </div>
                            <div class="metric-details">
                                <h5>Return Visitor Rate</h5>
                                <p>Repeat customers</p>
                            </div>
                        </div>
                        <div class="metric-value">42%</div>
                    </div>
                    <div class="metric-item">
                        <div class="metric-info">
                            <div class="metric-icon" style="background: var(--primary-blue);">
                                <i class="fas fa-share-alt"></i>
                            </div>
                            <div class="metric-details">
                                <h5>Social Media Mentions</h5>
                                <p>Online engagement</p>
                            </div>
                        </div>
                        <div class="metric-value">1,248</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Visitor Heat Map -->
        <div class="heatmap-section">
            <div class="section-header">
                <h3 class="section-title"><i class="fas fa-fire me-2"></i>Visitor Density Heat Map (Today)</h3>
                <div class="heatmap-legend">
                    <div class="legend-item">
                        <div class="legend-color" style="background: #e3f2fd;"></div>
                        <span>Low</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #4fc3f7;"></div>
                        <span>Medium</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #0288d1;"></div>
                        <span>High</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color" style="background: #01579b;"></div>
                        <span>Very High</span>
                    </div>
                </div>
            </div>
            <div class="heatmap-container">
                <div class="heatmap-grid" id="heatmapGrid">
                    <!-- Heat map cells will be populated by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Analytics Tables -->
        <div class="row analytics-tables">
            <div class="col-lg-6">
                <div class="table-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-trophy me-2"></i>Top Performing Rides</h3>
                        <button class="btn btn-sm btn-outline-primary" onclick="viewAllRides()">
                            View All
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="analytics-table">
                            <thead>
                                <tr>
                                    <th>Ride Name</th>
                                    <th>Riders Today</th>
                                    <th>Wait Time</th>
                                    <th>Revenue</th>
                                    <th>Rating</th>
                                </tr>
                            </thead>
                            <tbody id="topRidesTable">
                                <!-- Top rides data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="table-card">
                    <div class="chart-header">
                        <h3 class="chart-title"><i class="fas fa-terminal me-2"></i>Top Performing Terminals</h3>
                        <button class="btn btn-sm btn-outline-primary" onclick="viewAllTerminals()">
                            View All
                        </button>
                    </div>
                    <div class="table-responsive">
                        <table class="analytics-table">
                            <thead>
                                <tr>
                                    <th>Terminal</th>
                                    <th>Tickets</th>
                                    <th>Revenue</th>
                                    <th>Uptime</th>
                                    <th>Avg. Time</th>
                                </tr>
                            </thead>
                            <tbody id="topTerminalsTable">
                                <!-- Top terminals data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- AI Insights Section -->
        <div class="insights-section">
            <div class="section-header">
                <h3 class="section-title"><i class="fas fa-brain me-2"></i>AI-Powered Insights</h3>
                <button class="btn btn-sm btn-outline-primary" onclick="refreshInsights()">
                    <i class="fas fa-sync-alt me-1"></i>Refresh
                </button>
            </div>
            
            <div id="insightsList">
                <!-- Insights will be populated by JavaScript -->
            </div>
        </div>
    </div>
    
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts@3.35.0/dist/apexcharts.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
    <script>
        // Sample analytics data
        const analyticsData = {
            revenueData: [1250000, 1850000, 2200000, 3100000, 4200000, 4800000],
            visitorData: [800, 1250, 1800, 2500, 3400, 3891],
            ticketData: [520, 850, 1200, 1800, 2400, 2847],
            satisfactionData: [4.8, 4.7, 4.6, 4.5, 4.6, 4.6],
            categories: ['9 AM', '10 AM', '11 AM', '12 PM', '1 PM', '2 PM']
        };

        // Sample ride data
        const topRidesData = [
            { name: "Roller Coaster", riders: 520, waitTime: 60, revenue: "PKR 850,000", rating: 4.9 },
            { name: "Sky Screamer", riders: 420, waitTime: 25, revenue: "PKR 620,000", rating: 4.8 },
            { name: "Ferris Wheel", riders: 380, waitTime: 15, revenue: "PKR 450,000", rating: 4.5 },
            { name: "Water Splash", riders: 320, waitTime: 45, revenue: "PKR 380,000", rating: 4.7 },
            { name: "Bumper Cars", riders: 310, waitTime: 20, revenue: "PKR 320,000", rating: 4.3 }
        ];

        // Sample terminal data
        const topTerminalsData = [
            { name: "Main Gate #1", tickets: 842, revenue: "PKR 1,250,000", uptime: "99.8%", avgTime: "28 sec" },
            { name: "VIP Lounge", tickets: 89, revenue: "PKR 850,000", uptime: "99.5%", avgTime: "42 sec" },
            { name: "Ticket Kiosk #4", tickets: 312, revenue: "PKR 620,000", uptime: "99.2%", avgTime: "31 sec" },
            { name: "Ride Zone #5", tickets: 289, revenue: "PKR 750,000", uptime: "99.9%", avgTime: "35 sec" },
            { name: "Food Court #3", tickets: 156, revenue: "PKR 450,000", uptime: "98.5%", avgTime: "38 sec" }
        ];

        // Sample insights data
        const insightsData = [
            { 
                type: "success",
                title: "Peak Revenue Opportunity Identified",
                text: "Analysis shows that 2 PM to 4 PM generates 35% higher revenue per visitor. Consider targeted promotions during this window.",
                time: "Updated 30 mins ago",
                action: "View Detailed Analysis"
            },
            { 
                type: "warning",
                title: "Ride Capacity Bottleneck Detected",
                text: "Roller Coaster is operating at 92% capacity with 60-minute wait times. Consider increasing ride frequency or adding parallel tracks.",
                time: "Updated 1 hour ago",
                action: "Optimize Ride Schedule"
            },
            { 
                type: "success",
                title: "VIP Conversion Rate Increased",
                text: "VIP package conversions have increased by 18% this week. The new marketing campaign appears to be effective.",
                time: "Updated 2 hours ago",
                action: "View Campaign Analytics"
            },
            { 
                type: "warning",
                title: "West Gate Terminal Performance Decline",
                text: "Terminal #2 shows 15% lower transaction volume compared to average. May require maintenance or staff training.",
                time: "Updated 3 hours ago",
                action: "Check Terminal Status"
            }
        ];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Mobile menu toggle
            document.getElementById('mobileMenuBtn').addEventListener('click', function() {
                document.getElementById('sidebar').classList.toggle('mobile-open');
            });

            // Initialize date range picker
            $('#analyticsDateRange').daterangepicker({
                opens: 'left',
                startDate: moment().startOf('month'),
                endDate: moment().endOf('day'),
                ranges: {
                    'Today': [moment().startOf('day'), moment().endOf('day')],
                    'Yesterday': [moment().subtract(1, 'days').startOf('day'), moment().subtract(1, 'days').endOf('day')],
                    'Last 7 Days': [moment().subtract(6, 'days').startOf('day'), moment().endOf('day')],
                    'Last 30 Days': [moment().subtract(29, 'days').startOf('day'), moment().endOf('day')],
                    'This Month': [moment().startOf('month'), moment().endOf('month')],
                    'Last Month': [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
                },
                locale: {
                    format: 'MMM DD, YYYY'
                }
            });

            // Initialize KPI trend charts
            initializeKPITrends();

            // Initialize main charts
            initializeMainCharts();

            // Initialize secondary charts
            initializeSecondaryCharts();

            // Populate analytics tables
            populateAnalyticsTables();

            // Create heat map
            createHeatMap();

            // Populate insights
            populateInsights();

            // Update analytics in real-time
            setInterval(updateAnalytics, 30000);
        });

        // Initialize KPI trend charts
        function initializeKPITrends() {
            // Revenue trend
            const revenueOptions = {
                series: [{
                    data: analyticsData.revenueData.map(val => val / 1000000)
                }],
                chart: {
                    type: 'line',
                    height: 60,
                    sparkline: {
                        enabled: true
                    }
                },
                stroke: {
                    curve: 'smooth',
                    width: 3
                },
                colors: ['#0288d1'],
                tooltip: {
                    fixed: {
                        enabled: false
                    },
                    x: {
                        show: false
                    },
                    y: {
                        title: {
                            formatter: function() {
                                return 'PKR '
                            }
                        },
                        formatter: function(value) {
                            return value.toFixed(1) + 'M'
                        }
                    }
                }
            };

            const revenueChart = new ApexCharts(document.querySelector("#revenueTrend"), revenueOptions);
            revenueChart.render();

            // Visitors trend
            const visitorsOptions = {
                series: [{
                    data: analyticsData.visitorData.map(val => val / 100)
                }],
                chart: {
                    type: 'line',
                    height: 60,
                    sparkline: {
                        enabled: true
                    }
                },
                stroke: {
                    curve: 'smooth',
                    width: 3
                },
                colors: ['#28a745'],
                tooltip: {
                    fixed: {
                        enabled: false
                    },
                    x: {
                        show: false
                    },
                    y: {
                        title: {
                            formatter: function() {
                                return ''
                            }
                        },
                        formatter: function(value) {
                            return (value * 100).toFixed(0)
                        }
                    }
                }
            };

            const visitorsChart = new ApexCharts(document.querySelector("#visitorsTrend"), visitorsOptions);
            visitorsChart.render();

            // Tickets trend
            const ticketsOptions = {
                series: [{
                    data: analyticsData.ticketData.map(val => val / 100)
                }],
                chart: {
                    type: 'line',
                    height: 60,
                    sparkline: {
                        enabled: true
                    }
                },
                stroke: {
                    curve: 'smooth',
                    width: 3
                },
                colors: ['#6f42c1'],
                tooltip: {
                    fixed: {
                        enabled: false
                    },
                    x: {
                        show: false
                    },
                    y: {
                        title: {
                            formatter: function() {
                                return ''
                            }
                        },
                        formatter: function(value) {
                            return (value * 100).toFixed(0)
                        }
                    }
                }
            };

            const ticketsChart = new ApexCharts(document.querySelector("#ticketsTrend"), ticketsOptions);
            ticketsChart.render();

            // Satisfaction trend
            const satisfactionOptions = {
                series: [{
                    data: analyticsData.satisfactionData
                }],
                chart: {
                    type: 'line',
                    height: 60,
                    sparkline: {
                        enabled: true
                    }
                },
                stroke: {
                    curve: 'smooth',
                    width: 3
                },
                colors: ['#ffc107'],
                tooltip: {
                    fixed: {
                        enabled: false
                    },
                    x: {
                        show: false
                    },
                    y: {
                        title: {
                            formatter: function() {
                                return ''
                            }
                        },
                        formatter: function(value) {
                            return value.toFixed(1)
                        }
                    }
                }
            };

            const satisfactionChart = new ApexCharts(document.querySelector("#satisfactionTrend"), satisfactionOptions);
            satisfactionChart.render();
        }

        // Initialize main charts
        function initializeMainCharts() {
            // Revenue & Visitor Trends Chart
            const revenueVisitorOptions = {
                series: [
                    {
                        name: 'Revenue',
                        type: 'column',
                        data: analyticsData.revenueData
                    },
                    {
                        name: 'Visitors',
                        type: 'line',
                        data: analyticsData.visitorData
                    }
                ],
                chart: {
                    height: 350,
                    type: 'line',
                    toolbar: {
                        show: true
                    }
                },
                stroke: {
                    width: [0, 3]
                },
                colors: ['#0288d1', '#28a745'],
                dataLabels: {
                    enabled: false
                },
                xaxis: {
                    categories: analyticsData.categories
                },
                yaxis: [
                    {
                        title: {
                            text: 'Revenue (PKR)'
                        },
                        labels: {
                            formatter: function(value) {
                                return (value / 1000000).toFixed(1) + 'M';
                            }
                        }
                    },
                    {
                        opposite: true,
                        title: {
                            text: 'Visitors'
                        }
                    }
                ],
                tooltip: {
                    y: {
                        formatter: function(value, { seriesIndex }) {
                            if (seriesIndex === 0) {
                                return 'PKR ' + (value / 1000000).toFixed(2) + 'M';
                            } else {
                                return value.toLocaleString();
                            }
                        }
                    }
                }
            };

            const revenueVisitorChart = new ApexCharts(document.querySelector("#revenueVisitorChart"), revenueVisitorOptions);
            revenueVisitorChart.render();

            // Revenue by Category Chart
            const revenueCategoryOptions = {
                series: [44, 23, 18, 15],
                chart: {
                    type: 'donut',
                    height: 350
                },
                labels: ['Ticket Sales', 'Food & Beverage', 'Merchandise', 'VIP Services'],
                colors: ['#0288d1', '#4fc3f7', '#01579b', '#81d4fa'],
                responsive: [{
                    breakpoint: 480,
                    options: {
                        chart: {
                            width: 200
                        },
                        legend: {
                            position: 'bottom'
                        }
                    }
                }]
            };

            const revenueCategoryChart = new ApexCharts(document.querySelector("#revenueCategoryChart"), revenueCategoryOptions);
            revenueCategoryChart.render();
        }

        // Initialize secondary charts
        function initializeSecondaryCharts() {
            // Ride Utilization Chart
            const rideUtilizationOptions = {
                series: [{
                    data: [520, 420, 380, 320, 310, 290, 240, 210]
                }],
                chart: {
                    type: 'bar',
                    height: 300,
                    toolbar: {
                        show: false
                    }
                },
                plotOptions: {
                    bar: {
                        borderRadius: 8,
                        columnWidth: '60%',
                    }
                },
                dataLabels: {
                    enabled: false
                },
                xaxis: {
                    categories: ['Roller Coaster', 'Sky Screamer', 'Ferris Wheel', 'Water Splash', 'Bumper Cars', 'Haunted Mansion', 'Kiddie Train', 'Pirate Ship']
                },
                yaxis: {
                    title: {
                        text: 'Number of Riders'
                    }
                },
                colors: ['#0288d1']
            };

            const rideUtilizationChart = new ApexCharts(document.querySelector("#rideUtilizationChart"), rideUtilizationOptions);
            rideUtilizationChart.render();

            // Wait Time Chart
            const waitTimeOptions = {
                series: [{
                    name: 'Wait Time',
                    data: [60, 25, 15, 45, 20, 30, 10, 0]
                }],
                chart: {
                    height: 300,
                    type: 'line',
                    toolbar: {
                        show: false
                    }
                },
                stroke: {
                    width: 3,
                    curve: 'smooth'
                },
                xaxis: {
                    categories: ['Roller Coaster', 'Sky Screamer', 'Ferris Wheel', 'Water Splash', 'Bumper Cars', 'Haunted Mansion', 'Kiddie Train', 'Pirate Ship']
                },
                yaxis: {
                    title: {
                        text: 'Wait Time (minutes)'
                    }
                },
                colors: ['#4fc3f7']
            };

            const waitTimeChart = new ApexCharts(document.querySelector("#waitTimeChart"), waitTimeOptions);
            waitTimeChart.render();
        }

        // Populate analytics tables
        function populateAnalyticsTables() {
            // Top rides table
            const topRidesTable = document.getElementById('topRidesTable');
            topRidesTable.innerHTML = '';

            topRidesData.forEach(ride => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${ride.name}</strong></td>
                    <td>${ride.riders.toLocaleString()}</td>
                    <td>${ride.waitTime} min</td>
                    <td>${ride.revenue}</td>
                    <td><i class="fas fa-star text-warning"></i> ${ride.rating}</td>
                `;
                topRidesTable.appendChild(row);
            });

            // Top terminals table
            const topTerminalsTable = document.getElementById('topTerminalsTable');
            topTerminalsTable.innerHTML = '';

            topTerminalsData.forEach(terminal => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${terminal.name}</strong></td>
                    <td>${terminal.tickets.toLocaleString()}</td>
                    <td>${terminal.revenue}</td>
                    <td>${terminal.uptime}</td>
                    <td>${terminal.avgTime}</td>
                `;
                topTerminalsTable.appendChild(row);
            });
        }

        // Create heat map
        function createHeatMap() {
            const heatmapGrid = document.getElementById('heatmapGrid');
            heatmapGrid.innerHTML = '';

            // Define park zones (7 columns x 5 rows for demo)
            const zones = [
                'Main Gate', 'Food Court', 'Restrooms', 'Info Center', 'First Aid', 'Souvenir Shop', 'ATM',
                'Roller Coaster', 'Queue Area', 'Photo Booth', 'Snack Bar', 'Seating', 'Water Fountain', 'Rest Area',
                'Ferris Wheel', 'Bumper Cars', 'Kiddie Zone', 'Parent Lounge', 'Diaper Station', 'Play Area', 'Ice Cream',
                'Water World', 'Changing Rooms', 'Lockers', 'Towel Rental', 'Life Jackets', 'Showers', 'Sunscreen Station',
                'Adventure Zone', 'Rock Climbing', 'Zip Line', 'Rope Course', 'Safety Briefing', 'Equipment Rental', 'Photo Point'
            ];

            // Create 35 heat map cells (7 columns x 5 rows)
            for (let i = 0; i < 35; i++) {
                const cell = document.createElement('div');
                const intensity = Math.floor(Math.random() * 4); // 0-3 for intensity levels
                const intensityColors = ['#e3f2fd', '#4fc3f7', '#0288d1', '#01579b'];
                const intensityText = ['Low', 'Medium', 'High', 'Very High'];
                
                cell.className = 'heatmap-cell';
                cell.style.background = intensityColors[intensity];
                cell.title = `${zones[i]} - ${intensityText[intensity]} Density`;
                cell.textContent = zones[i].split(' ')[0]; // Show first word only
                
                heatmapGrid.appendChild(cell);
            }
        }

        // Populate insights
        function populateInsights() {
            const insightsList = document.getElementById('insightsList');
            insightsList.innerHTML = '';

            insightsData.forEach(insight => {
                const insightCard = document.createElement('div');
                insightCard.className = `insight-card ${insight.type}`;
                
                insightCard.innerHTML = `
                    <div class="insight-header">
                        <h6 class="insight-title">${insight.title}</h6>
                        <span class="insight-time">${insight.time}</span>
                    </div>
                    <p class="insight-text">${insight.text}</p>
                    <div class="insight-action" onclick="viewInsightDetail('${insight.title}')">
                        ${insight.action} <i class="fas fa-arrow-right"></i>
                    </div>
                `;
                insightsList.appendChild(insightCard);
            });
        }

        // Update analytics in real-time
        function updateAnalytics() {
            // Update KPI values with random changes
            const totalRevenue = document.getElementById('totalRevenue');
            const currentRevenue = parseFloat(totalRevenue.textContent.replace(/[PKR ,]/g, ''));
            const revenueChange = Math.floor(Math.random() * 200000) - 100000; // -100K to +100K
            totalRevenue.textContent = `PKR ${(currentRevenue + revenueChange).toLocaleString()}`;
            
            const totalVisitors = document.getElementById('totalVisitors');
            const currentVisitors = parseInt(totalVisitors.textContent.replace(/,/g, ''));
            const visitorChange = Math.floor(Math.random() * 50) - 25; // -25 to +25
            totalVisitors.textContent = (currentVisitors + visitorChange).toLocaleString();
            
            const ticketsSold = document.getElementById('ticketsSold');
            const currentTickets = parseInt(ticketsSold.textContent.replace(/,/g, ''));
            const ticketChange = Math.floor(Math.random() * 30) - 15; // -15 to +15
            ticketsSold.textContent = (currentTickets + ticketChange).toLocaleString();
            
            // Simulate real-time heat map updates
            const heatmapCells = document.querySelectorAll('.heatmap-cell');
            heatmapCells.forEach(cell => {
                if (Math.random() > 0.7) { // 30% chance to update
                    const intensity = Math.floor(Math.random() * 4);
                    const intensityColors = ['#e3f2fd', '#4fc3f7', '#0288d1', '#01579b'];
                    cell.style.background = intensityColors[intensity];
                }
            });
        }

        // Filter functions
        function applyAnalyticsFilters() {
            const dateRange = document.getElementById('analyticsDateRange').value;
            const comparisonPeriod = document.getElementById('comparisonPeriod').value;
            const dataGranularity = document.getElementById('dataGranularity').value;
            const parkZones = document.getElementById('parkZones').value;
            
            alert(`Analytics filters applied:\nDate Range: ${dateRange}\nComparison: ${comparisonPeriod}\nGranularity: ${dataGranularity}\nZones: ${parkZones}`);
            
            // Here you would fetch new data based on filters and re-render charts
        }

        function resetAnalyticsFilters() {
            document.getElementById('comparisonPeriod').value = 'none';
            document.getElementById('dataGranularity').value = 'daily';
            document.getElementById('parkZones').value = 'all';
            
            // Reset date range to this month
            $('#analyticsDateRange').data('daterangepicker').setStartDate(moment().startOf('month'));
            $('#analyticsDateRange').data('daterangepicker').setEndDate(moment().endOf('day'));
            
            // Refresh charts with default data
            initializeMainCharts();
        }

        function saveFilterPreset() {
            const presetName = prompt('Enter a name for this filter preset:');
            if (presetName) {
                alert(`Filter preset "${presetName}" saved successfully!`);
            }
        }

        // Action functions
        function generateReport() {
            alert('Generating comprehensive analytics report... This may take a few moments.');
            // Simulate report generation
            setTimeout(() => {
                alert('Analytics report generated successfully! Download will begin shortly.');
            }, 2000);
        }

        function scheduleReport() {
            alert('Opening report scheduling configuration...');
        }

        function exportRideData() {
            alert('Exporting ride utilization data to CSV...');
        }

        function exportWaitTimeData() {
            alert('Exporting wait time data to CSV...');
        }

        function viewAllRides() {
            alert('Opening detailed rides analytics...');
        }

        function viewAllTerminals() {
            alert('Opening detailed terminals analytics...');
        }

        function refreshInsights() {
            alert('Refreshing AI-powered insights...');
            // Simulate refreshing insights
            setTimeout(() => {
                populateInsights();
                alert('Insights refreshed successfully!');
            }, 1500);
        }

        function viewInsightDetail(insightTitle) {
            alert(`Viewing detailed analysis for: ${insightTitle}`);
        }
    </script>
</body>
</html>